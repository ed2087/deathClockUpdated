function calculateBMIMetric(e,t){return e/Math.pow(t,2)}function calculateBMIStandard(e,t){return 703*e/Math.pow(t,2)}function convertToInches(e,t){return 12*e+t}function calculateBMI_(){const e=document.getElementById("q23_"),t=document.getElementById("q24_"),n=parseFloat(e.value),o=t.value.split("."),s=parseFloat(o[0]),i=parseFloat(o[1]||0);if(isNaN(n)||isNaN(s)||isNaN(i)||n<=0||s<=0||i<0)return"Invalid Input";const r="standard";let a;if("metric"===r){const e=convertToInches(s,i),t=.0254*e,o=.453592*n;a=calculateBMIMetric(o,t)}else{const e=convertToInches(s,i);a=calculateBMIStandard(n,e)}return a.toFixed(2)}console.log("deathClock_questions.js loaded");const getQuestionsJson=async()=>{const e=await fetch_("/questionsAPI","GET");return e.questions},addToJson=(e,t,n)=>{const o=e.find(e=>e.id===t);o&&(o.user={userAnswer:n,points:0})},Q1_MAX_LENGTH=10,SPECIAL_CHARACTERS=["{","}","[","]","(",")","<",">","/","\\","|","~","`","!","@","#","$","%","^","&","*","+","=","?",":",";",'"',"'"],checkQ1=e=>{e.preventDefault();let t=id_("q1"),n=t.value;n.length>Q1_MAX_LENGTH&&(t.value=n.slice(0,Q1_MAX_LENGTH),n=t.value);const o=sanitizeInput(n);t.value=o,t.style.color="white"},convertToMetric=e=>{console.log("convertToMetric()"),e.preventDefault();let t=id_("q23_"),n=id_("q24_"),o=parseFloat(t.value),s=n.value.split("."),i=parseFloat(s[0]),r=parseFloat(s[1]||0);if(isNaN(r)||o<=0||i<=0||r<0)return;const a=convertToInches(i,r);let l=.0254*a,c=.453592*o;isNaN(c)&&(c=0),isNaN(l)&&(l=0),id_("metric_height").innerHTML=`${l.toFixed(2)} M`,id_("metric_weight").innerHTML=`${c.toFixed(2)} KG`};id_("q23_")&&(id_("q23_").addEventListener("change",convertToMetric),id_("q23_").addEventListener("keyup",convertToMetric)),id_("q24_")&&(id_("q24_").addEventListener("change",convertToMetric),id_("q24_").addEventListener("keyup",convertToMetric));const sanitizeInput=e=>{let t=e.trim();for(let e=0;e<SPECIAL_CHARACTERS.length;e++){const n=SPECIAL_CHARACTERS[e];t=t.split(n).join("")}return t},q1=id_("q1");q1&&q1.addEventListener("keyup",checkQ1);const checkAll=async e=>{e.preventDefault(),console.log("checkAll()");const t=queryAll_("input"),n=queryAll_("select"),o=[...t],s=[...n],i=o.every(e=>"email"===e.name||""!==e.value);if(!i){for(let e=0;e<o.length;e++)if(""===o[e].value){o[e].scrollIntoView();break}return}const r=s.map(e=>e.value);let a=await getQuestionsJson();addToJson(a,"q1",id_("q1").value),addToJson(a,"q2",id_("q2").value);let l=0;for(let e=0;e<s.length;e++)if(s[e]&&s[e].name)for(let t=0;t<a.length;t++)if(23!==a[t].id&&s[e].id.toLowerCase()===a[t].id.toLowerCase())for(let n=0;n<a[t].answer_options.length;n++){const o=r[e].trim().toLowerCase(),s=a[t].answer_options[n].option.trim().toLowerCase();o===s&&(l+=a[t].answer_options[n].scores[0],a[t].user={userAnswer:r[e],points:a[t].answer_options[n].scores[0]})}const c=id_("q23_").value,d=id_("q24_").value;addToJson(a,"q23",c),addToJson(a,"q24",d);const u=calculateBMI_();addToJson(a,"q25",u);const _={id:"userPermission",userPermission:id_("q_permission").value},v={_csrf:id_("csrf").value},h={totalPoints:l};a.push(h,_,v);const p=await sendJson("/questionsAPI","POST",a);if(p){const e=p.userShortId;window.location.href="/deathClock/results/"+e}else console.log("Error sending json");const q=id_("submit_btn");q.disabled=!0},healthForm=id_("healthForm");healthForm&&healthForm.addEventListener("submit",checkAll);